<div class="shortcodes_livePanels">
  <div class="shortcodes_livePanels_panels">
    <div class="shortcodes_livePanels_youtube">
      <div class="shortcodes_livePanels_nowPlaying" data-track-name="track-a"></div>
      <iframe
        width="560"
        height="315"
        src="https://www.youtube.com/embed/EVUCSrj83uM"
        title="YouTube video player"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
      ></iframe>
    </div>
    <div class="shortcodes_livePanels_youtube">
      <div class="shortcodes_livePanels_nowPlaying" data-track-name="track-b"></div>
      <iframe
        width="560"
        height="315"
        src="https://www.youtube.com/embed/w2m4u3wruJY"
        title="YouTube video player"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
      ></iframe>
    </div>
  </div>

  <div class="shortcodes_livePanels_panels">
    <div class="shortcodes_livePanels_timeline">
      <a
        class="twitter-timeline"
        data-width="100%"
        data-height="500"
        href="https://twitter.com/gocon_staff?ref_src=twsrc%5Etfw"
        >Tweets by gocon_staff</a
      >
      <script
        async
        src="https://platform.twitter.com/widgets.js"
        charset="utf-8"
      ></script>
    </div>
  </div>
</div>

<script>
const tracks = [
  {
    "name": "track-a",
    "playlist": [
      {
        "start": "10:00",
        "title": "ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°",
        "key": null
      },
      {
        "start": "10:10",
        "title": "Goã§é–‹ç™ºã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’6å¹´é–“é‹ç”¨ã—ãŸ\"ã—ãã˜ã‚Š\"",
        "key": "sponsor-miidas"
      },
      {
        "start": "10:30",
        "title": "ãƒŽãƒ³ãƒ‡ã‚¹ã‚¯ãƒ¯ãƒ¼ã‚«ãƒ¼å‘ã‘ãƒŽãƒ¼ã‚³ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®ã¤ã‚‰ã¿ãƒ»ã†ã¾ã¿",
        "key": "sponsor-kaminashi"
      },
      {
        "start": "10:50",
        "title": "ä¼‘æ†©",
        "key": null
      },
      {
        "start": "11:00",
        "title": "Developing games in Go for Nintendo Switchâ„¢",
        "key": "go-nintendo-switch"
      },
      {
        "start": "11:40",
        "title": "Learning Computer Systems by Crafting: Shell ï¼ˆä½œã£ã¦å­¦ã¶ã‚·ã‚§ãƒ«ï¼‰",
        "key": "crafting-shell"
      },
      {
        "start": "12:00",
        "title": "ãƒ©ãƒ³ãƒä¼‘æ†©",
        "key": null
      },
      {
        "start": "13:05",
        "title": "ã‚¹ãƒãƒ³ã‚µãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³: ãƒªãƒ¢ãƒ»ã‚¸ãƒ£ãƒ‘ãƒ³åˆåŒä¼šç¤¾",
        "key": "sponsor-remo-japan"
      },
      {
        "start": "13:10",
        "title": "Go Contextã‚’å®Œå…¨ã«ç†è§£ã™ã‚‹",
        "key": "understanding-go-context"
      },
      {
        "start": "13:50",
        "title": "Goã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§æ‰±ã†ãƒ•ã‚©ãƒ³ãƒˆã¨ç”»åƒ",
        "key": "go-stdlib-font-image"
      },
      {
        "start": "14:10",
        "title": "ä¼‘æ†©",
        "key": null
      },
      {
        "start": "14:20",
        "title": "goroutineã®ä»•çµ„ã¿ã«ã¤ã„ã¦",
        "key": "how-goroutine-works"
      },
      {
        "start": "14:40",
        "title": "ãƒžã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ç§»è¡Œã‚’ä»•ä¸Šã’ã‚‹æœ€å¾Œã®æ•°æ­©",
        "key": "microservice-last-steps"
      },
      {
        "start": "15:00",
        "title": "Golangã§ä½œã‚‹SQL Language Server(sqls)",
        "key": "golang-sqls"
      },
      {
        "start": "15:20",
        "title": "ä¼‘æ†©",
        "key": null
      },
      {
        "start": "15:40",
        "title": "io/fsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ãŸãƒ†ã‚¹ã‚¿ãƒ–ãƒ«ãªã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ«ã®é–‹ç™º",
        "key": "io-fs-testability"
      },
      {
        "start": "16:20",
        "title": "Floating Point Numbers and Decimal in Go",
        "key": "go-floating-point-and-decimal"
      },
      {
        "start": "16:40",
        "title": "ä¼‘æ†©",
        "key": null
      },
      {
        "start": "16:50",
        "title": "ã‚²ãƒ¼ãƒ ã‚µãƒ¼ãƒåŸºç›¤Takashoã‚’Goã§é–‹ç™ºã—ã¦è‰¯ã‹ã£ãŸç‚¹ã¨èª²é¡Œæ„Ÿ",
        "key": "sponsor-dena"
      },
      {
        "start": "17:10",
        "title": "äººç”Ÿã„ã‚ã„ã‚ãƒ¢ãƒŽãƒ¬ãƒã‚‚ã„ã‚ã„ã‚â™ª",
        "key": "sponsor-bitkey"
      },
      {
        "start": "17:30",
        "title": "ä¼‘æ†©",
        "key": null
      },
      {
        "start": "17:40",
        "title": "ä»Šæ—¥ã‹ã‚‰ä½¿ãˆã‚‹http.RoundTripper Tips",
        "key": "http-roundtripper"
      },
      {
        "start": "17:45",
        "title": "Goã®Proposalã®è¿½ã„æ–¹ã‚¬ã‚¤ãƒ‰",
        "key": "go-proposal-guide"
      },
      {
        "start": "17:50",
        "title": "Gormã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¸Šã’ãŸãŠè©±",
        "key": "gorm-update"
      },
      {
        "start": "17:55",
        "title": "Azure ADå¯¾å¿œã®èªè¨¼ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã‚’Goã§ä½œã£ã¦ã¿ãŸè©±",
        "key": "azure-ad-auth-server"
      },
      {
        "start": "18:00",
        "title": "net/httpã§ã¤ãã‚‹HTTPãƒ«ãƒ¼ã‚¿ãƒ¼è‡ªä½œå…¥é–€",
        "key": "handmade-http-router"
      },
      {
        "start": "18:05",
        "title": "golang/mockã§ã®ãƒ¢ãƒƒã‚¯ç”Ÿæˆã¨ç®¡ç†ã® \"ã‚ˆã‚Šè‰¯ã„\" ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ",
        "key": "better-golang-mock"
      },
      {
        "start": "18:10",
        "title": "Goã§é™çš„è§£æžã‚’ã¯ã˜ã‚ã¦ã¿ã‚ˆã†",
        "key": "go-static-analysis"
      },
      {
        "start": "18:15",
        "title": "Create Go WebDriver Client from Scratch",
        "key": "webdriver-client-from-scratch"
      },
      {
        "start": "18:30",
        "title": "ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°",
        "key": null
      }
    ]
  },
  {
    "name": "track-b",
    "playlist": [
      {
        "start": "11:40",
        "title": "Cloud Gaming Platform with Go",
        "key": "go-cloud-gaming-platform"
      },
      {
        "start": "12:00",
        "title": "ãƒ©ãƒ³ãƒä¼‘æ†©",
        "key": null
      },
      {
        "start": "13:10",
        "title": "Goã§è¶…é«˜é€Ÿã‹ã¤ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªé€†ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°APIã‚µãƒ¼ãƒãƒ¼ã‚’ä½œã£ã¦ã¿ãŸ",
        "key": "fast-scalable-reverse-geocoding"
      },
      {
        "start": "13:50",
        "title": "io/fs.FS for testability. io/fs.FS for abstraction.",
        "key": "io-fs-fs-testability-abstraction"
      },
      {
        "start": "14:10",
        "title": "ä¼‘æ†©",
        "key": null
      },
      {
        "start": "14:20",
        "title": "Goã¨GraphQLã‚’ä½¿ç”¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹é–‹ç™º",
        "key": "go-graphql-service"
      },
      {
        "start": "14:40",
        "title": "äºŒç›¸ã‚³ãƒŸãƒƒãƒˆãªã©ã®å…·ä½“ä¾‹ã«è¦‹ã‚‹ã‚´ãƒ«ãƒ¼ãƒãƒ³ã¨ãƒãƒ£ãƒãƒ«ã®ä½¿ã„ã©ã“ã‚",
        "key": "two-phase-commit"
      },
      {
        "start": "15:00",
        "title": "Write an embedded time-series database in Go",
        "key": "embedded-time-series-db"
      },
      {
        "start": "15:20",
        "title": "ä¼‘æ†©",
        "key": null
      },
      {
        "start": "15:40",
        "title": "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã‹ã‚‰å­¦ã¶Goãƒ©ãƒ³ã‚¿ã‚¤ãƒ  ã€œ code reading of runtime pkgã€œ",
        "key": "go-scheduling"
      },
      {
        "start": "16:20",
        "title": "ã€ŒðŸª¦å•é¡Œã€ã‹ã‚‰è€ƒãˆã‚‹Goã®Unicodeã‚µãƒãƒ¼ãƒˆ",
        "key": "go-unicode"
      },
      {
        "start": "16:40",
        "title": "çµ‚äº†",
        "key": null
      }
    ]
  }
];

const dayBeginning = new Date(Date.UTC(2021, 10, 13, 0, 0));
const toEpochMs = (japanTimeStr) => {
  const [h, m] = japanTimeStr.split(":").map((i) => +i);
  const timezoneOffset = -9 * 3600;
  return dayBeginning.valueOf() + (h * 3600 + m * 60 + timezoneOffset) * 1000;
};

const findCurrentSession = (now, sessions) => {
  const session = sessions
    .slice()
    .reverse()
    .find((session) => {
      const startMs = toEpochMs(session.start);
      return startMs <= now.valueOf();
    });
  return session;
};
  
setTimeout(() => {
  const now = new Date();
  for (const { name, playlist } of tracks) {
    const $nowPlaying = document.querySelector(`[data-track-name="${name}"]`);
    const session = findCurrentSession(now, playlist);
    let content;
    if (!session) {
      content = document.createTextNode('Waiting...');
    } else if (!session.key) {
      content = document.createTextNode(session.title);
    } else {
      content = document.createElement('a');
      content.target = '_blank';
      content.href= `./sessions/${session.key}`;
      content.textContent = `Now: ${session.title}`;
    }
    $nowPlaying.innerHTML = '';
    $nowPlaying.appendChild(content);
  }
}, 1000);
</script>